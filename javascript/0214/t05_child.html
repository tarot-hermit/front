<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>t05_child.html</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    'use strict';

    window.onload = () => {
      const params = new URLSearchParams(location.search);
      const mid = params.get("mid") || "";

      document.getElementById("demoMid").value = mid;
      document.getElementById("demoMid").focus();

      if (mid) document.getElementById("demoResult").innerHTML = `<span class="text-secondary">아이디를 확인해보세요.</span>`;
    };

    // ✅ (예시) 중복체크 로직(실제로는 서버/DB로 확인)
    function checkDup() {
      const mid = document.getElementById("demoMid").value.trim();
      if (!mid) {
        document.getElementById("demoResult").innerHTML = `<span class="text-danger">아이디를 입력하세요.</span>`;
        return;
      }

      // 예시: admin, hkd1234는 이미 사용중이라고 가정
      const used = ["admin", "hkd1234", "test"];
      const isDup = used.includes(mid.toLowerCase());

      document.getElementById("demoResult").innerHTML = isDup
        ? `<span class="text-danger fw-bold">사용 불가 (중복)</span>`
        : `<span class="text-success fw-bold">사용 가능</span>`;
    }

    function useThisId() {
    const childMidEl = document.getElementById("demoMid"); // ✅ 자식창 텍스트박스
    const mid = childMidEl.value.trim();                  // ✅ innerText ❌ / value ✅

    if (!mid) {
      alert("아이디를 입력하세요.");
      childMidEl.focus();
      return;
    }

    
    if (!window.opener || window.opener.closed) {
      alert("부모창이 없습니다.");
      return;
    }

    
    const parentMidEl = window.opener.document.getElementById("mid");
    if (!parentMidEl) {
      alert("부모창에서 id='mid' 요소를 찾을 수 없습니다.");
      return;
    }

    window.opener.document.getElementById("mid").value = mid;
    window.opener.document.getElementById("pwd").focus();      
    window.close();              
  }
  </script>
</head>

<body>
  <p><br/></p>
  <div class="container">
    <h2>아이디 중복체크</h2>
    <hr/>

    <div class="mb-3">
      <label class="form-label">아이디</label>
      <input type="text" id="demoMid" class="form-control" placeholder="아이디 입력">
    </div>

    <div class="d-flex gap-2">
      <button type="button" class="btn btn-primary" onclick="checkDup()">중복확인</button>
      <button type="button" class="btn btn-success" onclick="useThisId()">이 아이디 사용</button>
    </div>

    <div class="mt-3" id="demoResult"></div>

    <hr/>
    <div class="text-center">
      <input type="button" value="창닫기" onclick="window.close()" class="btn btn-outline-secondary">
    </div>
  </div>
</body>
</html>
