<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ex6.html</title>

  <!-- ✅ Bootstrap CSS 다시 추가 (이게 핵심) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <style>
    * { box-sizing: border-box; }

    body { background: #f5f6f8; }

    .calc-wrap{
      width: 380px;        /* ✅ max-width 말고 고정폭(폰 계산기 느낌) */
      margin: 24px auto;
      border-radius: 22px;
      overflow: hidden;
      box-shadow: 0 10px 30px rgba(0,0,0,.12);
      background: #111;
    }

    .calc-top { padding: 18px 16px 10px; background: #111; }

    /* ✅ 입력창을 검은 배경에 자연스럽게 */
    .calc-top input{
      width: 100%;
      border: 0;
      outline: 0;
      background: transparent;
      color: #fff;
    }

    #history{ color: rgba(255,255,255,.65); font-size: .95rem; }
    #display{ font-size: 2.4rem; font-weight: 700; }

    .calc-pad { padding: 12px; background: #161616; }

    .grid{
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr)); /* ✅ grid 안정화 */
      gap: 10px;
    }

    .btn-key{
      width: 100%;
      height: 64px;
      font-size: 1.25rem;
      font-weight: 600;
      border-radius: 16px;
    }

    .btn-key.op { font-size: 1.35rem; }
    .btn-key.zero { text-align: left; padding-left: 26px; }
    .span-2 { grid-column: span 2; }

    .hint{
      color: rgba(255,255,255,.45);
      font-size: .8rem;
      text-align: center;
      padding: 8px 0 12px;
      background: #111;
    }
  </style>

  <script>
    'use strict';

    let current = "0";
    let expr = "";
    let justEvaluated = false;

    function render() {
      document.getElementById("display").value = current;
      document.getElementById("history").value = expr;

      document.getElementById("demo").innerHTML =
        "식 : " + (expr === "" ? "(없음)" : expr) + "<br/>" +
        "현재값 : <b>" + current + "</b>";
    }

    function appendDigit(d) {
      if (justEvaluated) { expr = ""; current = "0"; justEvaluated = false; }
      if (current === "0" && d !== ".") current = "";
      if (d === "." && current.includes(".")) return;
      current += d;
      render();
    }

    function appendOp(op) {
      justEvaluated = false;
      if (current === "" || current === "-") return;

      if (expr === "") expr = current + " " + op + " ";
      else {
        if (/[+\-*/]\s$/.test(expr)) expr = expr.replace(/[+\-*/]\s$/, op + " ");
        else expr += current + " " + op + " ";
      }
      current = "0";
      render();
    }

    function allClear() { current="0"; expr=""; justEvaluated=false; render(); }

    function backspace() {
      if (justEvaluated) return;
      if (current.length <= 1 || (current.length === 2 && current.startsWith("-"))) current = "0";
      else current = current.slice(0, -1);
      render();
    }

    function toggleSign() {
      if (current === "0") return;
      current = current.startsWith("-") ? current.slice(1) : ("-" + current);
      render();
    }

    function percent() {
      const n = Number(current);
      if (Number.isNaN(n)) return;
      current = String(n / 100);
      render();
    }

    function evaluateExpr() {
      if (expr === "") { justEvaluated = true; render(); return; }

      let full = expr;
      if (/[+\-*/]\s$/.test(full)) full += current;

      const sanitized = full.replace(/[^0-9+\-*/. ]/g, "");
      try {
        const result = eval(sanitized);
        expr = full + " =";
        current = (result === Infinity || Number.isNaN(result)) ? "Error" : String(result);
        justEvaluated = true;
        render();
      } catch {
        current = "Error";
        justEvaluated = true;
        render();
      }
    }
  </script>
</head>

<body onload="render()">
  <div class="calc-wrap">
    <div class="calc-top">
      <input id="history" class="text-end" readonly placeholder="식(기록)" />
      <input id="display" class="text-end" readonly value="0" />
    </div>

    <div class="calc-pad">
      <div class="grid">
        <button type="button" class="btn btn-light btn-key" onclick="allClear()">C</button>
        <button type="button" class="btn btn-light btn-key" onclick="toggleSign()">±</button>
        <button type="button" class="btn btn-light btn-key" onclick="percent()">%</button>
        <button type="button" class="btn btn-warning btn-key op" onclick="appendOp('/')">÷</button>

        <button type="button" class="btn btn-dark text-white btn-key" onclick="appendDigit('7')">7</button>
        <button type="button" class="btn btn-dark text-white btn-key" onclick="appendDigit('8')">8</button>
        <button type="button" class="btn btn-dark text-white btn-key" onclick="appendDigit('9')">9</button>
        <button type="button" class="btn btn-warning btn-key op" onclick="appendOp('*')">×</button>

        <button type="button" class="btn btn-dark text-white btn-key" onclick="appendDigit('4')">4</button>
        <button type="button" class="btn btn-dark text-white btn-key" onclick="appendDigit('5')">5</button>
        <button type="button" class="btn btn-dark text-white btn-key" onclick="appendDigit('6')">6</button>
        <button type="button" class="btn btn-warning btn-key op" onclick="appendOp('-')">−</button>

        <button type="button" class="btn btn-dark text-white btn-key" onclick="appendDigit('1')">1</button>
        <button type="button" class="btn btn-dark text-white btn-key" onclick="appendDigit('2')">2</button>
        <button type="button" class="btn btn-dark text-white btn-key" onclick="appendDigit('3')">3</button>
        <button type="button" class="btn btn-warning btn-key op" onclick="appendOp('+')">+</button>

        <button type="button" class="btn btn-dark text-white btn-key zero span-2" onclick="appendDigit('0')">0</button>
        <button type="button" class="btn btn-dark text-white btn-key" onclick="appendDigit('.')">.</button>
        <button type="button" class="btn btn-success btn-key op" onclick="evaluateExpr()">=</button>

        <button type="button" class="btn btn-secondary btn-key span-2" onclick="backspace()">⌫</button>
        <button type="button" class="btn btn-secondary btn-key span-2" onclick="allClear()">AC</button>
      </div>
    </div>

    <div class="hint"><span id="demo"></span></div>
  </div>
</body>
</html>
